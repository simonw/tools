<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JSON Diff Tool</title>
  <style>
* {
  box-sizing: border-box;
}

body {
font-family: Helvetica, Arial, sans-serif;
margin: 0;
padding: 20px;
background: #f5f5f5;
min-height: 100vh;
}

.container {
max-width: 1400px;
margin: 0 auto;
}

h1 {
text-align: center;
color: #333;
margin-bottom: 10px;
}

.examples {
text-align: center;
margin-bottom: 20px;
padding: 12px;
background: #e8f4fc;
border-radius: 8px;
}

.examples span {
color: #666;
margin-right: 10px;
}

.examples a {
color: #0066cc;
text-decoration: none;
margin: 0 8px;
cursor: pointer;
}

.examples a:hover {
text-decoration: underline;
}

.input-section {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
margin-bottom: 20px;
}

.input-panel {
display: flex;
flex-direction: column;
}

.input-panel label {
font-weight: bold;
margin-bottom: 8px;
color: #444;
}

.input-panel textarea {
width: 100%;
height: 250px;
font-family: ‘Monaco’, ‘Menlo’, ‘Ubuntu Mono’, monospace;
font-size: 16px;
padding: 12px;
border: 2px solid #ddd;
border-radius: 8px;
resize: vertical;
background: #fff;
}

.input-panel textarea:focus {
outline: none;
border-color: #0066cc;
}

.left-panel textarea {
border-left: 4px solid #dc3545;
}

.right-panel textarea {
border-left: 4px solid #28a745;
}

.button-row {
display: flex;
justify-content: center;
gap: 12px;
margin-bottom: 20px;
}

button {
padding: 12px 28px;
font-size: 16px;
font-weight: bold;
border: none;
border-radius: 6px;
cursor: pointer;
transition: background 0.2s;
}

.compare-btn {
background: #0066cc;
color: white;
}

.compare-btn:hover {
background: #0055aa;
}

.clear-btn {
background: #666;
color: white;
}

.clear-btn:hover {
background: #555;
}

.swap-btn {
background: #6c757d;
color: white;
}

.swap-btn:hover {
background: #5a6268;
}

.error {
background: #ffe6e6;
border: 1px solid #dc3545;
color: #dc3545;
padding: 12px;
border-radius: 6px;
margin-bottom: 20px;
text-align: center;
}

.result-section {
background: white;
border-radius: 8px;
padding: 20px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.result-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 16px;
padding-bottom: 12px;
border-bottom: 1px solid #eee;
}

.result-header h2 {
margin: 0;
color: #333;
}

.legend {
display: flex;
gap: 20px;
font-size: 14px;
}

.legend-item {
display: flex;
align-items: center;
gap: 6px;
}

.legend-color {
width: 16px;
height: 16px;
border-radius: 3px;
}

.legend-added {
background: #d4edda;
border: 1px solid #28a745;
}

.legend-removed {
background: #f8d7da;
border: 1px solid #dc3545;
}

.legend-modified {
background: #fff3cd;
border: 1px solid #ffc107;
}

.diff-container {
font-family: ‘Monaco’, ‘Menlo’, ‘Ubuntu Mono’, monospace;
font-size: 14px;
line-height: 1.6;
overflow-x: auto;
}

.diff-line {
padding: 4px 12px;
border-radius: 3px;
margin: 2px 0;
white-space: pre-wrap;
word-break: break-word;
}

.diff-added {
background: #d4edda;
border-left: 4px solid #28a745;
}

.diff-removed {
background: #f8d7da;
border-left: 4px solid #dc3545;
}

.diff-modified {
background: #fff3cd;
border-left: 4px solid #ffc107;
}

.diff-unchanged {
color: #666;
}

.diff-path {
color: #0066cc;
font-weight: bold;
}

.diff-value {
color: #333;
}

.diff-old-value {
color: #dc3545;
text-decoration: line-through;
}

.diff-new-value {
color: #28a745;
}

.diff-arrow {
color: #666;
margin: 0 8px;
}

.summary {
display: flex;
gap: 20px;
margin-bottom: 16px;
padding: 12px;
background: #f8f9fa;
border-radius: 6px;
}

.summary-item {
font-size: 14px;
}

.summary-count {
font-weight: bold;
padding: 2px 8px;
border-radius: 12px;
margin-left: 4px;
}

.count-added {
background: #d4edda;
color: #155724;
}

.count-removed {
background: #f8d7da;
color: #721c24;
}

.count-modified {
background: #fff3cd;
color: #856404;
}

.no-diff {
text-align: center;
padding: 40px;
color: #28a745;
font-size: 18px;
}

.no-diff::before {
content: “✓ “;
}

@media (max-width: 768px) {
.input-section {
grid-template-columns: 1fr;
}

.legend {
flex-wrap: wrap;
gap: 10px;
}

.result-header {
flex-direction: column;
align-items: flex-start;
gap: 12px;
}
}
</style>

</head>
<body>
  <div class="container">
    <h1>JSON Diff Tool</h1>

```
<div class="examples">
  <span>Try examples:</span>
  <a onclick="loadExample('config')">Config changes</a>
  <a onclick="loadExample('user')">User profile update</a>
  <a onclick="loadExample('api')">API response versions</a>
  <a onclick="loadExample('nested')">Nested structure</a>
  <a onclick="loadExample('array')">Array modifications</a>
</div>

<div class="input-section">
  <div class="input-panel left-panel">
    <label for="json1">Original JSON (left)</label>
    <textarea id="json1" placeholder="Paste your original JSON here..."></textarea>
  </div>
  <div class="input-panel right-panel">
    <label for="json2">Modified JSON (right)</label>
    <textarea id="json2" placeholder="Paste your modified JSON here..."></textarea>
  </div>
</div>

<div class="button-row">
  <button class="compare-btn" onclick="compare()">Compare</button>
  <button class="swap-btn" onclick="swap()">⇄ Swap</button>
  <button class="clear-btn" onclick="clearAll()">Clear</button>
</div>

<div id="error" class="error" style="display: none;"></div>

<div id="result" class="result-section" style="display: none;">
  <div class="result-header">
    <h2>Differences</h2>
    <div class="legend">
      <div class="legend-item">
        <div class="legend-color legend-added"></div>
        <span>Added</span>
      </div>
      <div class="legend-item">
        <div class="legend-color legend-removed"></div>
        <span>Removed</span>
      </div>
      <div class="legend-item">
        <div class="legend-color legend-modified"></div>
        <span>Modified</span>
      </div>
    </div>
  </div>
  <div id="summary" class="summary"></div>
  <div id="diff" class="diff-container"></div>
</div>
```

  </div>

<script type="module">
const examples = {
  config: {
    left: {
      "appName": "MyApp",
      "version": "1.2.0",
      "debug": true,
      "database": {
        "host": "localhost",
        "port": 5432,
        "name": "myapp_dev"
      },
      "features": {
        "darkMode": false,
        "notifications": true,
        "analytics": false
      },
      "maxConnections": 10
    },
    right: {
      "appName": "MyApp",
      "version": "1.3.0",
      "debug": false,
      "database": {
        "host": "db.production.com",
        "port": 5432,
        "name": "myapp_prod",
        "ssl": true
      },
      "features": {
        "darkMode": true,
        "notifications": true,
        "analytics": true,
        "betaFeatures": false
      },
      "maxConnections": 100,
      "cacheEnabled": true
    }
  },
  user: {
    left: {
      "id": 12345,
      "username": "johndoe",
      "email": "john@example.com",
      "profile": {
        "firstName": "John",
        "lastName": "Doe",
        "age": 28,
        "bio": "Software developer"
      },
      "preferences": {
        "theme": "light",
        "language": "en",
        "timezone": "UTC"
      },
      "lastLogin": "2024-01-15T10:30:00Z"
    },
    right: {
      "id": 12345,
      "username": "johndoe",
      "email": "john.doe@newcompany.com",
      "profile": {
        "firstName": "John",
        "lastName": "Doe",
        "age": 29,
        "bio": "Senior software engineer at TechCorp",
        "avatar": "https://example.com/avatar.jpg"
      },
      "preferences": {
        "theme": "dark",
        "language": "en",
        "timezone": "America/New_York",
        "notifications": true
      },
      "lastLogin": "2024-03-20T14:45:00Z"
    }
  },
  api: {
    left: {
      "status": "success",
      "data": {
        "products": [
          {"id": 1, "name": "Widget", "price": 9.99, "stock": 100},
          {"id": 2, "name": "Gadget", "price": 19.99, "stock": 50}
        ],
        "pagination": {
          "page": 1,
          "perPage": 10,
          "total": 2
        }
      },
      "meta": {
        "apiVersion": "v1",
        "timestamp": "2024-01-01T00:00:00Z"
      }
    },
    right: {
      "status": "success",
      "data": {
        "products": [
          {"id": 1, "name": "Widget Pro", "price": 12.99, "stock": 75, "featured": true},
          {"id": 2, "name": "Gadget", "price": 19.99, "stock": 50},
          {"id": 3, "name": "Gizmo", "price": 29.99, "stock": 25}
        ],
        "pagination": {
          "page": 1,
          "perPage": 10,
          "total": 3,
          "hasMore": false
        }
      },
      "meta": {
        "apiVersion": "v2",
        "timestamp": "2024-06-01T00:00:00Z",
        "deprecationWarning": null
      }
    }
  },
  nested: {
    left: {
      "company": {
        "name": "TechStartup Inc",
        "departments": {
          "engineering": {
            "headCount": 15,
            "teams": {
              "frontend": {"members": 5, "lead": "Alice"},
              "backend": {"members": 6, "lead": "Bob"}
            }
          },
          "marketing": {
            "headCount": 8,
            "budget": 50000
          }
        }
      }
    },
    right: {
      "company": {
        "name": "TechStartup Inc",
        "departments": {
          "engineering": {
            "headCount": 25,
            "teams": {
              "frontend": {"members": 8, "lead": "Alice", "remote": true},
              "backend": {"members": 10, "lead": "Charlie"},
              "devops": {"members": 4, "lead": "Diana"}
            }
          },
          "marketing": {
            "headCount": 12,
            "budget": 75000
          },
          "sales": {
            "headCount": 6,
            "budget": 40000
          }
        }
      }
    }
  },
  array: {
    left: {
      "playlist": {
        "name": "Road Trip Mix",
        "songs": [
          {"title": "Highway Star", "artist": "Deep Purple", "duration": 367},
          {"title": "Born to Run", "artist": "Bruce Springsteen", "duration": 270},
          {"title": "Life is a Highway", "artist": "Tom Cochrane", "duration": 261}
        ],
        "totalDuration": 898,
        "isPublic": false
      }
    },
    right: {
      "playlist": {
        "name": "Ultimate Road Trip Mix",
        "songs": [
          {"title": "Highway Star", "artist": "Deep Purple", "duration": 367},
          {"title": "Radar Love", "artist": "Golden Earring", "duration": 378},
          {"title": "Born to Run", "artist": "Bruce Springsteen", "duration": 270},
          {"title": "Take It Easy", "artist": "Eagles", "duration": 211}
        ],
        "totalDuration": 1226,
        "isPublic": true,
        "followers": 42
      }
    }
  }
};

function deepDiff(obj1, obj2, path = '') {
  const diffs = [];
  const allKeys = new Set([...Object.keys(obj1 || {}), ...Object.keys(obj2 || {})]);
  
  for (const key of allKeys) {
    const currentPath = path ? `${path}.${key}` : key;
    const val1 = obj1?.[key];
    const val2 = obj2?.[key];
    
    if (!(key in (obj1 || {}))) {
      diffs.push({type: 'added', path: currentPath, value: val2});
    } else if (!(key in (obj2 || {}))) {
      diffs.push({type: 'removed', path: currentPath, value: val1});
    } else if (typeof val1 !== typeof val2) {
      diffs.push({type: 'modified', path: currentPath, oldValue: val1, newValue: val2});
    } else if (typeof val1 === 'object' && val1 !== null && !Array.isArray(val1)) {
      diffs.push(...deepDiff(val1, val2, currentPath));
    } else if (Array.isArray(val1) && Array.isArray(val2)) {
      if (JSON.stringify(val1) !== JSON.stringify(val2)) {
        diffs.push({type: 'modified', path: currentPath, oldValue: val1, newValue: val2, isArray: true});
      }
    } else if (val1 !== val2) {
      diffs.push({type: 'modified', path: currentPath, oldValue: val1, newValue: val2});
    }
  }
  
  return diffs;
}

function formatValue(value) {
  if (typeof value === 'string') return `"${value}"`;
  if (value === null) return 'null';
  if (Array.isArray(value) || typeof value === 'object') {
    return JSON.stringify(value, null, 2);
  }
  return String(value);
}

function renderDiff(diffs) {
  if (diffs.length === 0) {
    return '<div class="no-diff">The JSON documents are identical</div>';
  }
  
  return diffs.map(diff => {
    const pathHtml = `<span class="diff-path">${diff.path}</span>`;
    
    if (diff.type === 'added') {
      return `<div class="diff-line diff-added">+ ${pathHtml}: <span class="diff-new-value">${formatValue(diff.value)}</span></div>`;
    } else if (diff.type === 'removed') {
      return `<div class="diff-line diff-removed">− ${pathHtml}: <span class="diff-old-value">${formatValue(diff.value)}</span></div>`;
    } else {
      return `<div class="diff-line diff-modified">± ${pathHtml}: <span class="diff-old-value">${formatValue(diff.oldValue)}</span><span class="diff-arrow">→</span><span class="diff-new-value">${formatValue(diff.newValue)}</span></div>`;
    }
  }).join('');
}

function renderSummary(diffs) {
  const added = diffs.filter(d => d.type === 'added').length;
  const removed = diffs.filter(d => d.type === 'removed').length;
  const modified = diffs.filter(d => d.type === 'modified').length;
  
  return `
    <div class="summary-item">Added: <span class="summary-count count-added">${added}</span></div>
    <div class="summary-item">Removed: <span class="summary-count count-removed">${removed}</span></div>
    <div class="summary-item">Modified: <span class="summary-count count-modified">${modified}</span></div>
  `;
}

window.compare = function() {
  const json1 = document.getElementById('json1').value.trim();
  const json2 = document.getElementById('json2').value.trim();
  const errorDiv = document.getElementById('error');
  const resultDiv = document.getElementById('result');
  
  errorDiv.style.display = 'none';
  resultDiv.style.display = 'none';
  
  if (!json1 || !json2) {
    errorDiv.textContent = 'Please paste JSON in both fields';
    errorDiv.style.display = 'block';
    return;
  }
  
  let obj1, obj2;
  
  try {
    obj1 = JSON.parse(json1);
  } catch (e) {
    errorDiv.textContent = `Invalid JSON in left field: ${e.message}`;
    errorDiv.style.display = 'block';
    return;
  }
  
  try {
    obj2 = JSON.parse(json2);
  } catch (e) {
    errorDiv.textContent = `Invalid JSON in right field: ${e.message}`;
    errorDiv.style.display = 'block';
    return;
  }
  
  const diffs = deepDiff(obj1, obj2);
  
  document.getElementById('summary').innerHTML = renderSummary(diffs);
  document.getElementById('diff').innerHTML = renderDiff(diffs);
  resultDiv.style.display = 'block';
};

window.swap = function() {
  const json1 = document.getElementById('json1');
  const json2 = document.getElementById('json2');
  const temp = json1.value;
  json1.value = json2.value;
  json2.value = temp;
};

window.clearAll = function() {
  document.getElementById('json1').value = '';
  document.getElementById('json2').value = '';
  document.getElementById('error').style.display = 'none';
  document.getElementById('result').style.display = 'none';
};

window.loadExample = function(name) {
  const example = examples[name];
  if (example) {
    document.getElementById('json1').value = JSON.stringify(example.left, null, 2);
    document.getElementById('json2').value = JSON.stringify(example.right, null, 2);
    compare();
  }
};
</script>

</body>
</html>
